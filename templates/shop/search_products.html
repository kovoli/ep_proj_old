{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="product-section section mt-20 mb-20">
    <div class="container">
        <div class="row">
            <div class="col-12">
            <h2 class="my-4 text-center">"{{ search_list.count }}" совпадений по запросу - "{{ q|upper }}"</h2>
                <!-- Shop Product Wrap Start -->
                <div class="shop-product-wrap grid row">
                    {% for product in products_list %}
                    <div class="col-xl-3 col-lg-4 col-md-6 col-12 pb-30 pt-10">
                        <!-- Product Start -->
                        <div class="ee-product">
                            <!-- Image -->
                            <div class="image d-flex mx-auto align-items-center justify-content-center">
                                <a href="{{ product.get_absolute_url }}">
                                    <img class="p-2 mx-auto d-block img-fluid" src="{% if product.product_image_category %}
                                                                                    {{ product.product_image_category.url }}
                                                                                    {% else %}
                                                                                    {% static 'images/zagluschka.png' %}
                                                                                    {% endif %}" alt=""></a>
                            </div>
                            <!-- Content -->
                            <div class="content">
                                <!-- Category & Title -->
                                <div class="category-title">
                                    <h5 class="title"><a href="{{ product.get_absolute_url }}">{{ product.name|truncatechars:70 }}</a></h5>
                                </div>
                                <!-- Price & Ratting -->
                                <div class="price-ratting">
                                    <h5 class="price">от {{ product.min_price }} <i class="fas fa-ruble-sign"></i></h5>
                                </div>
                            </div>
                        </div><!-- Product End -->
                    </div>
                    {% empty %}
                        <p>К сожалению ничего не найденно. Попробуйте перефразировать ваш поиск</p>
                    {% endfor %}
                </div><!-- Shop Product Wrap End -->
            {% if products_list.has_other_pages %}
                <div class="row mt-30">
                    <div class="col">
                        <ul class="pagination">
                            {% if products_list.has_previous %}
                                <li><a href="?page=1{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}"><i class="fas fa-angle-double-left"></i></a></li>
                                <li><a href="?page={{ products_list.previous_page_number }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}"><i class="fas fa-angle-left"></i></a></li>
                            {% endif %}
                            {% for i in products_list.paginator.page_range %}

                                {% if products_list.number == i %}
                                    <li class="active">
                                        <a>{{ i }}</a>
                                    </li>
                                {% elif i|add:"-5" <= products_list.number and products_list.number <= i|add:"2" %}
                                    <li><a href="?page={{ i }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}">{{ i }}</a></li>
                                {% endif %}
                            {% endfor %}

                            {% if products_list.has_next %}
                                <li><a href="?page={{ products_list.next_page_number }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}"><i class="fas fa-angle-right"></i></a></li>
                                <li><a href="?page={{ products_list.paginator.num_pages }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}"><i class="fas fa-angle-double-right"></i></a></li>
                            {% endif %}
                        </ul>
                    </div>
                </div>
            {% endif %}

            </div>
        </div>
    </div>
</div>
{% endblock content %}